---
import { navItemsRO, navItemsEN } from '../composables/navItems.js';
import { getTranslatedUrl } from '../composables/pageTranslations.js';

const { lang, currentPath } = Astro.props;

// Automatically choose the correct navItems based on the language
const navItems = lang === 'en' ? navItemsEN : navItemsRO;

const languages = [
  { 
    code: "ro", 
    label: "Romana", 
    flag: "ðŸ‡·ðŸ‡´", 
    url: getTranslatedUrl(currentPath, 'ro')
  },
  { 
    code: "en", 
    label: "English", 
    flag: "ðŸ‡¬ðŸ‡§", 
    url: getTranslatedUrl(currentPath, 'en')
  },
];

// Fallback to Romanian if the language is not found
const currentLang = languages.find(l => l.code === lang) || languages[0];
const otherLanguages = languages.filter(l => l.code !== lang);
---

<nav>
  <!-- HOME LINK -->
  <a href={navItems.home.href}>{navItems.home.label}</a>

  <!-- MAIN NAV -->
  <ul>
    {navItems.items.map(item => (
      <li>
        <a href={item.href}>{item.label}</a>
      </li>
    ))}
  </ul>

  <!-- LANGUAGE DROPDOWN -->
  <details>
    <summary>{currentLang.flag} {currentLang.label}</summary>
    <ul>
      {otherLanguages.map(l => (
        <li>
          <a href={l.url}>{l.flag} {l.label}</a>
        </li>
      ))}
    </ul>
  </details>

  <!-- CONTACT BUTTON SLOT -->
  <div class="contact-btn">
    <slot name="contact-button" />
  </div>
</nav>